<!doctype html>

<html lang="en">

<head>
    <meta charset="utf-8">
    <title>Document</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <link rel="stylesheet" type="text/css" href="/style.css"/>
</head>

<script>
    function showTextarea() {
        document.getElementById('review').style.display = "block"
        document.getElementById("title").style.display = "block"
        document.getElementById("post-button").style.display = "inline-block"
        document.getElementById("add-review-button").style.display = "none"
        document.getElementById("cancel-button").style.display = "inline-block"
    }

    function hideTextarea() {
        document.getElementById("review").style.display = "none"
        document.getElementById("title").style.display = "none"
        document.getElementById("post-button").style.display = "none"
        document.getElementById("cancel-button").style.display = "none"
        document.getElementById("review").value = ""
        document.getElementById("title").value = ""
        document.getElementById("add-review-button").style.display = "block"
    }

    function saveAndHideTextarea() {
        document.getElementById("review").style.display = "none"
        document.getElementById("title").style.display = "none"
        document.getElementById("post-button").style.display = "none"
        document.getElementById("cancel-button").style.display = "none"
        document.getElementById("add-review-button").style.display = "block"
    }
</script>

<body>


<div><a href="/dashboard">Back to all users</a></div>
<h2 class="student">
    Student:
    <%= name %>,
    <%= prisonNumber %>
</h2>

<div class="grid-container">
    <div class="column-2">
        
        
            <h2><%= name %>'s reflections: </h2>
        
        
            <table>
                <% for (var i = posts.length - 1; i>=0; i--) { %>
                    <tr>
                        <% if (posts[i].comment) { %>
                        <td class="post">
                                <b><%= posts[i].date %>: </b>
                                <p class="break"><%= posts[i].text %></p>
                                <br/>
                            </td>
                       
                        <td class="comment">
                            <p><b>You commented: </b></p>
                            <p class="break"> <%= posts[i].comment %></p>
                            <form action="/view/comment %>" method="POST">
                                <div>
                                    <input type="hidden" name="postId" value="<%= posts[i].id %>">
                                    <input type="hidden" name="prisonNumber" value="<%= prisonNumber %>">
                                    <input type="hidden" id="name" name="name" value="<%= name %>">
                                    <input type="hidden" id="postText" name="text" value="<%= posts[i].text %>">
                                    <input type="hidden" id="postComment" name="comment" value="<%= posts[i].comment %>">
                                    <input type="hidden" id="postDate" name="date" value="<%= posts[i].date %>">
                                    <input class="right" type="submit" value="Edit">
                                </div>
                            </form>
                                </td>
                            </tr>
                            
                                <% } else { %>
                                        <tr>
                                            <td class="post">
                                                <b><%= posts[i].date %>: </b>
                                                <p class="break"><%= posts[i].text %></p>
                                                <br/>
                                            </td>
                                            <td class="comment">
                                            
                                                <p style="display:inline-block;"><i>Not commented yet</i></p>
                                            
                                            <form action="/view/comment %>" method="POST">
                                                <input type="hidden" name="postId" value="<%= posts[i].id %>">
                                                <input type="hidden" name="prisonNumber" value="<%= prisonNumber %>">
                                                <input type="hidden" id="name" name="name" value="<%= name %>">
                                                <input type="hidden" id="text" name="text" value="<%= posts[i].text %>">
                                                <input type="hidden" id="comment" name="comment" value="<%= posts[i].comment %>">
                                                <input type="hidden" id="date" name="date" value="<%= posts[i].date %>">
                                                <input type="submit" class="right" style="color: white; background-color:#DD4A48; display:inline-block" value="Comment">
                                            
                                        </form>
                                        <br/>
                                    </td>
                                    </tr>
                                        <% } %>
                      
                    <% } %>
        
            </table> 
        </div>
        
    <div class="column-1">
        <h2><%= name %>'s project reviews: 
            
            <button id="add-review-button" class="right" onclick="showTextarea()" style="display:block">Add a review</button>
            
            <form action="/dashboard/<%= prisonNumber %>" method="POST">
                <input type="hidden" id="name" name="name" value="<%= name %>">
                <input type="text" id="title" name="title" size="32" style="display:none" placeholder="Project title" maxlength="30" required>
                <textarea id="review" name="review" style="display:none" rows="20" cols="64" placeholder="Write a new review..." required></textarea>
                <input type="submit" onclick="saveAndhideTextarea()" id="post-button" style="display:none" value="Post">
                <button id="cancel-button" onclick="hideTextarea()"  style="display:none">Cancel</button>
            </form> 
        </h2>
        
        
       
       
            
        
        <table>
            <% if (!reviews[0]) { %>
                <p><i>No reviews yet</i></p>
            <% } else { %> 
        <% for (var i = reviews.length - 1; i>=0; i--) { %>
            <tr>
                <td class="review">
                    <b><%= reviews[i].title %></b>
                    <i class="right"><%= reviews[i].date %></i>
                </td>
                <td>
                    <p class="break"><%= reviews[i].review %></p>
                
                <form action="/view/review" method="POST">
                    <input type="hidden" id="prisonNumber" name="prisonNumber" value="<%= prisonNumber %>">
                    <input type="hidden" id="review" name="review" value="<%= reviews[i].review %>">
                    <input type="hidden" id="reviewId" name="reviewId" value="<%= reviews[i].id %>">
                    <input type="hidden" id="name" name="name" value="<%= name %>">
                    <input type="hidden" id="title" name="title" value="<%= reviews[i].title %>">
                    <input type="hidden" id="date" name="date" value="<%= reviews[i].date %>">
                    <input type="submit" class="right" value="Edit">
                </form> 
            </td>
            </tr>
            
            <%}%>
            <%}%>
    </table>
</div>



</div>
</body>

</html>